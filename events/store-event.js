const EventEmitter = require('events')
const eventEmitter = new EventEmitter()

function CreateStore() {
    const _subscribers = [];
    const _products = [];

    const notifyFunction = () => {
        for (const suscriber of _subscribers) {
            suscriber.notify(_products);
        }
    }

    eventEmitter.on('notify', notifyFunction);

    const subscribe = (observer) => {
        _subscribers.push(observer);
    }

    const addProduct = (product) => {
        _products.push(product);
        eventEmitter.emit('notify');
    }

    return {
        subscribe,
        addProduct,
    }
}

function Observer(name) {
    const notify = (products) => {
        console.log(`Notify to ${name}`);
        console.table(products)
    }

    return {
        notify,
    }
}


function main() {
    const observer1 = Observer('oberver1');
    const observer2 = Observer('oberver2');
    
    const store = CreateStore();

    store.subscribe(observer1);
    store.subscribe(observer2);
    store.addProduct({ product: 'Pizza', price: 12 });
}

main()